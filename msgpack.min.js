{const e=4294967296,t=t=>{let r=new Uint8Array(128),n=0;function i(t){null==t?o(192):(t.constructor===String?function(e){const t=function(e){let t=!0;for(let r=0;r<e.length;r++)if(e.charCodeAt(r)>=128){t=!1;break}let r=0,n=new Uint8Array(e.length*(t?1:4));for(let t=0;t!=e.length;t++){let i=e.charCodeAt(t);if(i<128)n[r++]=i;else{if(i<2048)n[r++]=i>>6|192;else{if(i>55295&&i<56320){if(++t>=e.length)throw new Error("UTF8 encode: incomplete surrogate pair");const o=e.charCodeAt(t);if(o<56320||o>57343)throw new Error("UTF8 encode: second surrogate character 0x"+o.toString(16)+" at index "+t+" out of range");i=65536+((1023&i)<<10)+(1023&o),n[r++]=i>>18|240,n[r++]=i>>12&63|128}else n[r++]=i>>12|224;n[r++]=i>>6&63|128}n[r++]=63&i|128}}return t?n:n.subarray(0,r)}(e),r=t.length;r<=31?o(160+r):f(r<=255?[217,r]:r<=65535?[218,r>>>8,r]:[219,r>>>24,r>>>16,r>>>8,r]),f(t)}:t.constructor===Number?function(t){if(isFinite(t)&&Math.floor(t)===t){if(t>=0&&t<=127)o(t);else if(t<0&&t>=-32)o(t);else if(t>0&&t<=255)f([204,t]);else if(t>=-128&&t<=127)f([208,t]);else if(t>0&&t<=65535)f([205,t>>>8,t]);else if(t>=-32768&&t<=32767)f([209,t>>>8,t]);else if(t>0&&t<=4294967295)f([206,t>>>24,t>>>16,t>>>8,t]);else if(t>=-2147483648&&t<=2147483647)f([210,t>>>24,t>>>16,t>>>8,t]);else if(t>0&&t<=0x10000000000000000){let r=t/e,n=t%e;f([211,r>>>24,r>>>16,r>>>8,r,n>>>24,n>>>16,n>>>8,n])}else if(t>=-0x8000000000000000&&t<=0x8000000000000000){let r,n;t>=0?(r=t/e,n=t%e):(t++,r=Math.abs(t)/e,n=Math.abs(t)%e,r=~r,n=~n),f([211,r>>>24,r>>>16,r>>>8,r,n>>>24,n>>>16,n>>>8,n])}else f(t<0?[211,128,0,0,0,0,0,0,0]:[207,255,255,255,255,255,255,255,255]);return}const r=new ArrayBuffer(8);new DataView(r).setFloat64(0,t),o(203),f(new Uint8Array(r))}:t.constructor===Boolean?function(e){o(e?195:194)}:Array.isArray(t)?function(e){const t=e.length;t<=15?o(144+t):f(t<=65535?[220,t>>>8,t]:[221,t>>>24,t>>>16,t>>>8,t]);for(const t of e)i(t)}:t instanceof Date?function(t){let r=t.getTime()/1e3;if(0===t.getMilliseconds()&&r<4294967296)f([214,255,r>>>24,r>>>16,r>>>8,r]);else{let n=1e6*t.getMilliseconds();if(r<17179869184){let r=t.getTime()/1e3;f([215,255,n>>>22,n>>>14,n>>>6,n<<2>>>0|r/e,r>>>24,r>>>16,r>>>8,r])}else{let r=t.getTime()/1e3;hi=r/e,lo=r%e,f([199,12,255,n>>>24,n>>>16,n>>>8,n,hi>>>24,hi>>>16,hi>>>8,hi,lo>>>24,lo>>>16,lo>>>8,lo])}}}:function(e){let t=0;for(const r in e)t++;t<=15?o(128+t):f(t<=65535?[222,t>>>8,t]:[223,t>>>24,t>>>16,t>>>8,t]);for(const t in e)i(t),i(e[t])})(t)}function o(e){if(r.length<n+1){let e=2*r.length;for(;e<n+1;)e*=2;const t=new Uint8Array(e);t.set(r),r=t}r[n]=e,n++}function f(e){if(r.length<n+e.length){let t=2*r.length;for(;t<n+e.length;)t*=2;const i=new Uint8Array(t);i.set(r),r=i}r.set(e,n),n+=e.length}return i(t),r.subarray(0,n)},r=t=>{let r=0;return n();function n(){const e=t[r++];if(e>=0&&e<=127)return e;if(e>=128&&e<=143)return l(e-128);if(e>=144&&e<=159)return c(e-144);if(e>=160&&e<=191)return s(e-160);if(192===e)return null;if(193===e)throw new Error("Invalid byte code 0xc1 found.");if(194===e)return!1;if(195===e)return!0;if(196===e)return u(1);if(197===e)return u(2);if(198===e)return u(4);if(199===e)return a(-1,1);if(200===e)return a(-1,2);if(201===e)return a(-1,4);if(202===e)return f(4);if(203===e)return f(8);if(204===e)return o(1);if(205===e)return o(2);if(206===e)return o(4);if(207===e)return o(8);if(208===e)return i(1);if(209===e)return i(2);if(210===e)return i(4);if(211===e)return i(8);if(212===e)return a(1);if(213===e)return a(2);if(214===e)return a(4);if(215===e)return a(8);if(216===e)return a(16);if(217===e)return s(-1,1);if(218===e)return s(-1,2);if(219===e)return s(-1,4);if(220===e)return c(-1,2);if(221===e)return c(-1,4);if(222===e)return l(-1,2);if(223===e)return l(-1,4);if(e>=224&&e<=255)return e-256;throw new Error("Matched no byte code. Value is "+e+". This should never happen.")}function i(e){let n=0,i=!0;for(;e-- >0;)if(i){let e=t[r++];n+=127&e,128&e&&(n-=128),i=!1}else n*=256,n+=t[r++];return n}function o(e){let n=0;for(;e-- >0;)n*=256,n+=t[r++];return n}function f(e){const n=new DataView(t.buffer,r,e);return r+=e,4===e?n.getFloat32(0,!1):8===e?n.getFloat64(0,!1):void 0}function u(e){const n=t.subarray(r,r+e);return r+=e,n}function l(e,t){e<0&&(e=o(t));const r={};for(;e-- >0;){r[n()]=n()}return r}function c(e,t){e<0&&(e=o(t));const r=[];for(;e-- >0;)r.push(n());return r}function s(e,t){return e<0&&(e=o(t)),function(e){let t=0,r="";for(;t<e.length;){let n=e[t++];if(n>127)if(n>191&&n<224){if(t>=e.length)throw new Error("UTF8 decode: incomplete 2-byte sequence");n=(31&n)<<6|63&e[t++]}else if(n>223&&n<240){if(t+1>=e.length)throw new Error("UTF8 decode: incomplete 3-byte sequence");n=(15&n)<<12|(63&e[t++])<<6|63&e[t++]}else{if(!(n>239&&n<248))throw new Error("UTF8 decode: unknown multibyte start 0x"+n.toString(16)+" at index "+(t-1));if(t+2>=e.length)throw new Error("UTF8 decode: incomplete 4-byte sequence");n=(7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++]}if(n<=65535)r+=String.fromCharCode(n);else{if(!(n<=1114111))throw new Error("UTF8 decode: code point 0x"+n.toString(16)+" exceeds UTF-16 reach");n-=65536,r+=String.fromCharCode(n>>10|55296),r+=String.fromCharCode(1023&n|56320)}}return r}(u(e))}function a(t,r){t<0&&(t=o(r));const n=o(1),i=u(t);return 255===n?function(t){if(4===t.length)return new Date(1e3*((t[0]<<24>>>0)+(t[1]<<16>>>0)+(t[2]<<8>>>0)+t[3]));if(8===t.length){const r=(t[0]<<22>>>0)+(t[1]<<14>>>0)+(t[2]<<6>>>0)+(t[3]>>>2),n=(3&t[3])*e+(t[4]<<24>>>0)+(t[5]<<16>>>0)+(t[6]<<8>>>0)+t[7];return new Date(1e3*n+r/1e6)}if(12===t.length){const r=(t[0]<<24>>>0)+(t[1]<<16>>>0)+(t[2]<<8>>>0)+t[3],n=(t[4]<<24>>>0)+(t[5]<<16>>>0)+(t[6]<<8>>>0)+t[7],i=(t[8]<<24>>>0)+(t[9]<<16>>>0)+(t[10]<<8>>>0)+t[11],o=n*e+i;return new Date(1e3*o+r/1e6)}throw new Error("Invalid data length for a date value.")}(i):{type:n,data:i}}};"undefined"!=typeof module?module.exports={encode:t,decode:r}:this.msgpack={encode:t,decode:r}}